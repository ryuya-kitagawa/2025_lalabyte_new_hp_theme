{"version":3,"file":"hum.js","sources":["../../src/js/modules/hamburger-menu.js","../../src/js/hum.js"],"sourcesContent":["// =============================================================================\r\n// ハンバーガーメニュー\r\n// =============================================================================\r\n\r\n// モジュールスコープで初期化フラグを管理（クロージャーを使用）\r\nconst hamburgerMenuState = {\r\n  isInitialized: false\r\n};\r\n\r\nexport function initHamburgerMenu() {\r\n  // 二重実行防止\r\n  if (hamburgerMenuState.isInitialized) {\r\n    console.log('[Hamburger Menu] 既に初期化済みです');\r\n    return;\r\n  }\r\n\r\n  // 【重要】ビルド時の変数名圧縮による衝突を防ぐため、hum.js の変数名と異なる名前にする\r\n  const hamburgerBtn = document.querySelector('.openbtn4');\r\n  const hamburgerNav = document.querySelector('.l-spnav');\r\n  const hamburgerBody = document.body;\r\n\r\n  // デバッグ: 要素が見つからない場合に警告\r\n  if (!hamburgerBtn) {\r\n    console.warn('[Hamburger Menu] .openbtn4 が見つかりません');\r\n    return;\r\n  }\r\n  if (!hamburgerNav) {\r\n    console.warn('[Hamburger Menu] .l-spnav が見つかりません');\r\n    return;\r\n  }\r\n\r\n  hamburgerMenuState.isInitialized = true;\r\n\r\n  let hamburgerScrollPosition = 0;\r\n\r\n  // デバッグ: 初期化成功をログに出力\r\n  console.log('[Hamburger Menu] 初期化完了', { openBtn: hamburgerBtn, spNav: hamburgerNav });\r\n\r\n  // トグル処理の共通関数\r\n  // 【重要】ビルド時の変数名圧縮による衝突を防ぐため、パラメータ名を明確にする\r\n  // 【重要】関数名が c に圧縮される可能性があるため、関数内の変数名は c 以外にする\r\n  function toggleHamburgerMenu(toggleEventParam) {\r\n    if (toggleEventParam) {\r\n      // cancelableでない場合はpreventDefaultを呼ばない（スクロール中など）\r\n      if (toggleEventParam.cancelable) {\r\n        toggleEventParam.preventDefault();\r\n      }\r\n      toggleEventParam.stopPropagation();\r\n    }\r\n\r\n    console.log('[Hamburger Menu] ボタンがクリックされました');\r\n\r\n    // 【重要】関数名 toggleHamburgerMenu が c に圧縮される可能性があるため、変数名を明確にする\r\n    const hamburgerMenuOpeningFlag = !hamburgerBtn.classList.contains('active');\r\n\r\n    // ボタンとメニューにactiveクラスを付け外し\r\n    hamburgerBtn.classList.toggle('active');\r\n    hamburgerNav.classList.toggle('active');\r\n\r\n    console.log('[Hamburger Menu] クラスを切り替えました', {\r\n      openBtnActive: hamburgerBtn.classList.contains('active'),\r\n      spNavActive: hamburgerNav.classList.contains('active')\r\n    });\r\n\r\n    // 背景のスクロールを制御\r\n    if (hamburgerMenuOpeningFlag) {\r\n      // メニューを開く時：スクロール位置を保存して固定\r\n      hamburgerScrollPosition = window.pageYOffset || document.documentElement.scrollTop;\r\n      hamburgerBody.style.top = `-${hamburgerScrollPosition}px`;\r\n      hamburgerBody.classList.add('no-scroll');\r\n    } else {\r\n      // メニューを閉じる時：スクロール位置を復元\r\n      hamburgerBody.classList.remove('no-scroll');\r\n      hamburgerBody.style.top = '';\r\n      window.scrollTo(0, hamburgerScrollPosition);\r\n    }\r\n  }\r\n\r\n  // 1. ボタンをクリック/タッチしたときの処理（iOS Safari対応）\r\n  // 【重要】ブロックスコープで囲み、ビルド時の変数名圧縮による衝突を防ぐ\r\n  {\r\n    // touchstartを優先して即座に反応させる\r\n    hamburgerBtn.addEventListener('touchstart', function (touchStartEvent) {\r\n      toggleHamburgerMenu(touchStartEvent);\r\n    }, { passive: false });\r\n\r\n    // clickイベントも追加（デスクトップ対応）\r\n    hamburgerBtn.addEventListener('click', function (clickEvent) {\r\n      toggleHamburgerMenu(clickEvent);\r\n    });\r\n  }\r\n\r\n  // 2. メニュー内のリンクをクリックしたときの処理\r\n  // 【重要】ブロックスコープで囲み、forEachのコールバックパラメータの衝突を防ぐ\r\n  {\r\n    const hamburgerNavLinks = hamburgerNav.querySelectorAll('a');\r\n    hamburgerNavLinks.forEach(function (hamburgerLinkElement) {\r\n      hamburgerLinkElement.addEventListener('click', function () {\r\n        hamburgerBtn.classList.remove('active');\r\n        hamburgerNav.classList.remove('active');\r\n        hamburgerBody.classList.remove('no-scroll');\r\n        hamburgerBody.style.top = '';\r\n        window.scrollTo(0, hamburgerScrollPosition);\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\n","// =============================================================================\r\n// hum.js - ハンバーガーメニュー\r\n// =============================================================================\r\n\r\nimport { initHamburgerMenu } from './modules/hamburger-menu.js';\r\n\r\n// 【重要】グローバルスコープへの変数漏洩を防ぐため、IIFEで包む\r\n(() => {\r\n  'use strict';\r\n\r\n  // 初期化関数（複数回試行可能、最大5回まで）\r\n  // 【重要】ビルド時の変数名圧縮による衝突を防ぐため、hamburger-menu.js の変数名と異なる名前にする\r\n  let humInitAttempts = 0;\r\n  const humMaxAttempts = 5;\r\n\r\n  function humTryInit() {\r\n    humInitAttempts++;\r\n    const humOpenBtn = document.querySelector('.openbtn4');\r\n    const humSpNav = document.querySelector('.l-spnav');\r\n    \r\n    if (humOpenBtn && humSpNav) {\r\n      console.log('[Hamburger Menu] 要素が見つかりました。初期化を実行します。');\r\n      initHamburgerMenu();\r\n    } else if (humInitAttempts < humMaxAttempts) {\r\n      console.warn(`[Hamburger Menu] 要素が見つかりません（試行 ${humInitAttempts}/${humMaxAttempts}）。再試行します...`, { openBtn: humOpenBtn, spNav: humSpNav });\r\n      // 要素が見つからない場合、少し待ってから再試行\r\n      setTimeout(humTryInit, 200);\r\n    } else {\r\n      console.error('[Hamburger Menu] 要素が見つかりませんでした。初期化を中止します。', { openBtn: humOpenBtn, spNav: humSpNav });\r\n    }\r\n  }\r\n\r\n  // iOS Safari対応：確実に初期化\r\n  if (document.readyState === 'loading') {\r\n    document.addEventListener('DOMContentLoaded', humTryInit);\r\n  } else if (document.readyState === 'interactive' || document.readyState === 'complete') {\r\n    // 既に読み込み済みの場合（iOS Safari対応のため少し遅延）\r\n    // DOMContentLoadedが既に発火している可能性があるため、少し待ってから実行\r\n    setTimeout(humTryInit, 50);\r\n  } else {\r\n    // その他の場合はDOMContentLoadedを待つ\r\n    document.addEventListener('DOMContentLoaded', humTryInit);\r\n  }\r\n})();\r\n"],"names":["hamburgerMenuState","isInitialized","humInitAttempts","humTryInit","humOpenBtn","document","querySelector","humSpNav","console","log","hamburgerBtn","hamburgerNav","hamburgerBody","body","warn","hamburgerScrollPosition","toggleHamburgerMenu","toggleEventParam","cancelable","preventDefault","stopPropagation","hamburgerMenuOpeningFlag","classList","contains","toggle","openBtnActive","spNavActive","window","pageYOffset","documentElement","scrollTop","style","top","add","remove","scrollTo","openBtn","spNav","addEventListener","touchStartEvent","passive","clickEvent","querySelectorAll","forEach","hamburgerLinkElement","initHamburgerMenu","setTimeout","error","readyState"],"mappings":"AAKA,MAAMA,EAAqB,CACzBC,eAAe,GAoGjB,MC9FE,IAAIC,EAAkB,EAGtB,SAASC,IACPD,IACA,MAAME,EAAaC,SAASC,cAAc,aACpCC,EAAWF,SAASC,cAAc,YAEpCF,GAAcG,GAChBC,QAAQC,IAAI,0CDZX,WAEL,GAAIT,EAAmBC,cAErB,YADAO,QAAQC,IAAI,8BAKd,MAAMC,EAAeL,SAASC,cAAc,aACtCK,EAAeN,SAASC,cAAc,YACtCM,EAAgBP,SAASQ,KAG/B,IAAKH,EAEH,YADAF,QAAQM,KAAK,uCAGf,IAAKH,EAEH,YADAH,QAAQM,KAAK,sCAIfd,EAAmBC,eAAgB,EAEnC,IAAIc,EAA0B,EAQ9B,SAASC,EAAoBC,GACvBA,IAEEA,EAAiBC,YACnBD,EAAiBE,iBAEnBF,EAAiBG,mBAGnBZ,QAAQC,IAAI,kCAGZ,MAAMY,GAA4BX,EAAaY,UAAUC,SAAS,UAGlEb,EAAaY,UAAUE,OAAO,UAC9Bb,EAAaW,UAAUE,OAAO,UAE9BhB,QAAQC,IAAI,+BAAgC,CAC1CgB,cAAef,EAAaY,UAAUC,SAAS,UAC/CG,YAAaf,EAAaW,UAAUC,SAAS,YAI3CF,GAEFN,EAA0BY,OAAOC,aAAevB,SAASwB,gBAAgBC,UACzElB,EAAcmB,MAAMC,IAAM,IAAIjB,MAC9BH,EAAcU,UAAUW,IAAI,eAG5BrB,EAAcU,UAAUY,OAAO,aAC/BtB,EAAcmB,MAAMC,IAAM,GAC1BL,OAAOQ,SAAS,EAAGpB,GAEvB,CAxCAP,QAAQC,IAAI,yBAA0B,CAAE2B,QAAS1B,EAAc2B,MAAO1B,IA8CpED,EAAa4B,iBAAiB,aAAc,SAAUC,GACpDvB,EAAoBuB,EACtB,EAAG,CAAEC,SAAS,IAGd9B,EAAa4B,iBAAiB,QAAS,SAAUG,GAC/CzB,EAAoByB,EACtB,GAM0B9B,EAAa+B,iBAAiB,KACtCC,QAAQ,SAAUC,GAClCA,EAAqBN,iBAAiB,QAAS,WAC7C5B,EAAaY,UAAUY,OAAO,UAC9BvB,EAAaW,UAAUY,OAAO,UAC9BtB,EAAcU,UAAUY,OAAO,aAC/BtB,EAAcmB,MAAMC,IAAM,GAC1BL,OAAOQ,SAAS,EAAGpB,EACrB,EACF,EAEJ,CCpFM8B,IACS3C,EAVU,GAWnBM,QAAQM,KAAK,kCAAkCZ,iBAAgD,CAAEkC,QAAShC,EAAYiC,MAAO9B,IAE7HuC,WAAW3C,EAAY,MAEvBK,QAAQuC,MAAM,4CAA6C,CAAEX,QAAShC,EAAYiC,MAAO9B,GAE7F,CAG4B,YAAxBF,SAAS2C,WACX3C,SAASiC,iBAAiB,mBAAoBnC,GACb,gBAAxBE,SAAS2C,YAAwD,aAAxB3C,SAAS2C,WAG3DF,WAAW3C,EAAY,IAGvBE,SAASiC,iBAAiB,mBAAoBnC,EAElD,ED+DA"}