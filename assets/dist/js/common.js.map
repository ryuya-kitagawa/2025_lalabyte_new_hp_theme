{"version":3,"file":"common.js","sources":["../../src/js/modules/header-scroll.js","../../src/js/modules/tabs.js","../../src/js/modules/smooth-scroll.js","../../src/js/modules/faq-accordion.js","../../src/js/common.js"],"sourcesContent":["// =============================================================================\r\n// スクロールヘッダー\r\n// =============================================================================\r\n// フェーズ2：jQuery置換済み\r\n\r\n// throttle関数（パフォーマンス対策）\r\nfunction throttle(func, wait) {\r\n  let timeout;\r\n  return function executedFunction(...args) {\r\n    const later = () => {\r\n      clearTimeout(timeout);\r\n      func(...args);\r\n    };\r\n    clearTimeout(timeout);\r\n    timeout = setTimeout(later, wait);\r\n  };\r\n}\r\n\r\nlet isInitialized = false;\r\n\r\nexport function initHeaderScroll() {\r\n  // 二重実行防止\r\n  if (isInitialized) {\r\n    return;\r\n  }\r\n  isInitialized = true;\r\n  const header = document.querySelector('.l-header');\r\n  \r\n  // ヘッダー要素が存在しない場合は何もしない\r\n  if (!header) {\r\n    return;\r\n  }\r\n\r\n  // スクロール処理\r\n  const handleScroll = () => {\r\n    // ------------------------------------\r\n    // ★ 追加： _white_bg (記事詳細) がある場合はスクロール処理をしない\r\n    // ------------------------------------\r\n    if (header.classList.contains('_white_bg')) {\r\n      return; // ここで処理終了\r\n    }\r\n\r\n    const scrollTop = window.pageYOffset || document.documentElement.scrollTop;\r\n    const isWhite = header.classList.contains('_white'); // 下層ページ判定\r\n    const winWidth = window.innerWidth;\r\n\r\n    // ------------------------------------\r\n    // SP（<=767px）では TOPページの挙動を完全OFF\r\n    // ------------------------------------\r\n    if (winWidth <= 767 && !isWhite) {\r\n      // TOPページの ._scrolled を削除して固定\r\n      header.classList.remove('_scrolled');\r\n      return; // ← TOPページは処理終了\r\n    }\r\n\r\n    // --- TOPページ（_white なし） ---\r\n    if (!isWhite) {\r\n      if (scrollTop > 0) {\r\n        header.classList.add('_scrolled');\r\n      } else {\r\n        header.classList.remove('_scrolled');\r\n      }\r\n      return;\r\n    }\r\n\r\n    // --- 下層ページ（_white あり） ---\r\n    let trigger = 0;\r\n    const subClass = '_scrolled-sub';\r\n\r\n    // 1920px 幅のときだけ 630px をトリガーに\r\n    if (winWidth === 1920) {\r\n      trigger = 630;\r\n    }\r\n\r\n    if (scrollTop > trigger) {\r\n      header.classList.add(subClass);\r\n    } else {\r\n      header.classList.remove(subClass);\r\n    }\r\n  };\r\n\r\n  // throttleでスクロールイベントを最適化（16ms = 約60fps）\r\n  const throttledHandleScroll = throttle(handleScroll, 16);\r\n\r\n  // スクロールイベントを登録\r\n  window.addEventListener('scroll', throttledHandleScroll, { passive: true });\r\n  \r\n  // 初回実行（ページ読み込み時の状態を反映）\r\n  handleScroll();\r\n}\r\n","// =============================================================================\r\n// タブ切り替え\r\n// =============================================================================\r\n// フェーズ1：jQuery置換済み\r\n\r\n// タブコンテナ単位で初期化（複数タブ対応）\r\nconst initializedContainers = new Set();\r\n\r\n/**\r\n * data属性の値を安全に取得（ハイフン/アンダースコア両対応）\r\n * - data-tab-target / data-tab_target のどちらでもOK\r\n */\r\nfunction getDataValue(el, kebabName, underscoreName) {\r\n  if (!el) return '';\r\n  // 1) getAttribute で直接（最も確実）\r\n  const v1 = el.getAttribute(kebabName);\r\n  if (v1 && String(v1).trim() !== '') return String(v1).trim();\r\n  const v2 = el.getAttribute(underscoreName);\r\n  if (v2 && String(v2).trim() !== '') return String(v2).trim();\r\n\r\n  // 2) dataset（念のため）\r\n  // data-tab-target => dataset.tabTarget\r\n  if (el.dataset && el.dataset.tabTarget && String(el.dataset.tabTarget).trim() !== '') {\r\n    return String(el.dataset.tabTarget).trim();\r\n  }\r\n  // data-tab_target => dataset.tab_target（ブラウザによってはここに入る）\r\n  if (el.dataset && el.dataset.tab_target && String(el.dataset.tab_target).trim() !== '') {\r\n    return String(el.dataset.tab_target).trim();\r\n  }\r\n\r\n  return '';\r\n}\r\n\r\nfunction getTabKey(tabEl) {\r\n  return getDataValue(tabEl, 'data-tab-target', 'data-tab_target');\r\n}\r\n\r\nfunction getPanelKey(panelEl) {\r\n  return getDataValue(panelEl, 'data-tab-panel', 'data-tab_panel');\r\n}\r\n\r\n/**\r\n * タブコンテナを初期化\r\n * @param {HTMLElement} root - タブコンテナのルート要素\r\n */\r\nfunction initTabContainer(root) {\r\n  if (!root) return;\r\n\r\n  // 既に初期化済みのコンテナはスキップ\r\n  if (initializedContainers.has(root)) return;\r\n  initializedContainers.add(root);\r\n\r\n  const tabs = Array.from(root.querySelectorAll('[data-tab_target], [data-tab-target]'));\r\n  const panels = Array.from(root.querySelectorAll('[data-tab_panel], [data-tab-panel]'));\r\n\r\n  if (tabs.length === 0 || panels.length === 0) return;\r\n\r\n  // 有効なタブ/パネルのみ抽出（キーが空のものは除外）\r\n  const validTabs = tabs.filter(t => getTabKey(t));\r\n  const validPanels = panels.filter(p => getPanelKey(p));\r\n\r\n  // data属性が全滅ならここで止める（原因が即わかる）\r\n  if (validTabs.length === 0 || validPanels.length === 0) {\r\n    console.warn('[Tabs] 有効なdata属性が見つかりません。HTMLのdata属性名を確認してください。', {\r\n      container: root,\r\n      tabs: tabs.map(t => ({ el: t, tabKey: getTabKey(t) })),\r\n      panels: panels.map(p => ({ el: p, panelKey: getPanelKey(p) })),\r\n    });\r\n    return;\r\n  }\r\n\r\n  // ✅ 初期アクティブ候補を「リセット前」に確保\r\n  const preActiveTab =\r\n    validTabs.find(t => t.classList.contains('is_active')) ||\r\n    validTabs.find(t => t.getAttribute('aria-selected') === 'true') ||\r\n    null;\r\n\r\n  // 初期状態：タブ/パネルを全部リセット\r\n  tabs.forEach(tab => {\r\n    tab.classList.remove('is_active');\r\n    tab.setAttribute('aria-selected', 'false');\r\n  });\r\n\r\n  panels.forEach(panel => {\r\n    panel.classList.remove('is_active');\r\n    panel.setAttribute('hidden', 'hidden');\r\n  });\r\n\r\n  // タブ切り替え処理\r\n  function switchTab(tabElement) {\r\n    const targetKey = getTabKey(tabElement);\r\n\r\n    if (!targetKey) {\r\n      console.warn('[Tabs] クリックされたタブのキーが取得できません（data-tab-target / data-tab_target を確認）', {\r\n        element: tabElement,\r\n        container: root\r\n      });\r\n      return;\r\n    }\r\n\r\n    // タブ切替\r\n    tabs.forEach(tab => {\r\n      tab.classList.remove('is_active');\r\n      tab.setAttribute('aria-selected', 'false');\r\n    });\r\n\r\n    tabElement.classList.add('is_active');\r\n    tabElement.setAttribute('aria-selected', 'true');\r\n\r\n    // パネル切替（一致するキーだけ表示）\r\n    panels.forEach(panel => {\r\n      const panelKey = getPanelKey(panel);\r\n      if (!panelKey) return;\r\n\r\n      if (panelKey === targetKey) {\r\n        panel.classList.add('is_active');\r\n        panel.removeAttribute('hidden');\r\n      } else {\r\n        panel.classList.remove('is_active');\r\n        panel.setAttribute('hidden', 'hidden');\r\n      }\r\n    });\r\n  }\r\n\r\n  // ✅ 初期表示：preActiveがあればそれ、なければ先頭タブ\r\n  switchTab(preActiveTab || validTabs[0]);\r\n\r\n  // イベント登録（有効タブのみ）\r\n  validTabs.forEach(tab => {\r\n    tab.addEventListener(\r\n      'touchstart',\r\n      function (ev) {\r\n        if (ev.cancelable) ev.preventDefault();\r\n        switchTab(this);\r\n      },\r\n      { passive: false }\r\n    );\r\n\r\n    tab.addEventListener('click', function (ev) {\r\n      ev.preventDefault();\r\n      switchTab(this);\r\n    });\r\n  });\r\n}\r\n\r\nexport function initTabs() {\r\n  const containers = document.querySelectorAll('[data-site_tabs], [data-site-tabs]');\r\n  if (containers.length === 0) return;\r\n\r\n  containers.forEach(container => initTabContainer(container));\r\n}\r\n","// =============================================================================\r\n// スムーススクロール\r\n// =============================================================================\r\n// フェーズ1：jQuery置換済み\r\n\r\nlet isInitialized = false;\r\n\r\nexport function initSmoothScroll() {\r\n  // 二重実行防止\r\n  if (isInitialized) {\r\n    return;\r\n  }\r\n  isInitialized = true;\r\n\r\n  const offset = 100; // 上に空けたい余白(px)\r\n\r\n  document.addEventListener('click', function (e) {\r\n    const link = e.target.closest('a[href^=\"#\"]');\r\n    if (!link) return;\r\n\r\n    const href = link.getAttribute('href');\r\n    const targetId = href === '#' || href === '' ? 'html' : href;\r\n    const target = document.querySelector(targetId);\r\n\r\n    if (target) {\r\n      e.preventDefault();\r\n      const position = target.getBoundingClientRect().top + window.pageYOffset - offset;\r\n\r\n      window.scrollTo({\r\n        top: position,\r\n        behavior: 'smooth'\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\n","// =============================================================================\r\n// FAQアコーディオン\r\n// =============================================================================\r\n// フェーズ1：jQuery置換済み（CSS transitionでslideToggleを再現）\r\n\r\nlet isInitialized = false;\r\n\r\nexport function initFaqAccordion() {\r\n  // 二重実行防止\r\n  if (isInitialized) {\r\n    return;\r\n  }\r\n  isInitialized = true;\r\n\r\n  const questions = document.querySelectorAll('.c-faq__question');\r\n  \r\n  questions.forEach(question => {\r\n    question.addEventListener('click', function () {\r\n      const answer = this.nextElementSibling;\r\n      if (!answer || !answer.classList.contains('c-faq__answer')) {\r\n        return;\r\n      }\r\n\r\n      // 開閉状態をトグル\r\n      const isOpen = this.classList.toggle('is-open');\r\n      \r\n      // アニメーション用のクラスを追加\r\n      answer.classList.add('c-faq__answer--animating');\r\n      \r\n      if (isOpen) {\r\n        // 開く：高さを取得してアニメーション\r\n        answer.style.height = '0';\r\n        answer.style.overflow = 'hidden';\r\n        answer.style.display = 'block';\r\n        const height = answer.scrollHeight;\r\n        answer.style.height = height + 'px';\r\n        \r\n        // アニメーション完了後に高さをautoに\r\n        setTimeout(() => {\r\n          answer.style.height = 'auto';\r\n          answer.style.overflow = '';\r\n          answer.classList.remove('c-faq__answer--animating');\r\n        }, 250);\r\n      } else {\r\n        // 閉じる：現在の高さから0へ\r\n        answer.style.height = answer.scrollHeight + 'px';\r\n        // リフローを強制\r\n        answer.offsetHeight;\r\n        answer.style.height = '0';\r\n        \r\n        setTimeout(() => {\r\n          answer.style.display = 'none';\r\n          answer.style.height = '';\r\n          answer.classList.remove('c-faq__answer--animating');\r\n        }, 250);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n","// =============================================================================\r\n// common.js - エントリーポイント\r\n// =============================================================================\r\n// 各モジュールを読み込んで初期化\r\n\r\nimport { initHeaderScroll } from './modules/header-scroll.js';\r\nimport { initTabs } from './modules/tabs.js';\r\nimport { initSmoothScroll } from './modules/smooth-scroll.js';\r\nimport { initFaqAccordion } from './modules/faq-accordion.js';\r\n\r\n// DOMContentLoadedで初期化（iOS Safari対応）\r\nfunction initAll() {\r\n  initHeaderScroll();\r\n  initTabs();\r\n  initSmoothScroll();\r\n  initFaqAccordion();\r\n}\r\n\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', initAll);\r\n} else {\r\n  // 既に読み込み済みの場合（iOS Safari対応のため少し遅延）\r\n  if (document.readyState === 'complete') {\r\n    // 完全に読み込み済みの場合は即座に実行\r\n    initAll();\r\n  } else {\r\n    // 読み込み中の場合はDOMContentLoadedを待つ\r\n    document.addEventListener('DOMContentLoaded', initAll);\r\n  }\r\n}\r\n"],"names":["isInitialized","initHeaderScroll","header","document","querySelector","handleScroll","classList","contains","scrollTop","window","pageYOffset","documentElement","isWhite","winWidth","innerWidth","remove","add","trigger","subClass","throttledHandleScroll","func","wait","timeout","args","clearTimeout","setTimeout","throttle","addEventListener","passive","initializedContainers","Set","getDataValue","el","kebabName","underscoreName","v1","getAttribute","String","trim","v2","dataset","tabTarget","tab_target","getTabKey","tabEl","getPanelKey","panelEl","initTabs","containers","querySelectorAll","length","forEach","container","root","has","tabs","Array","from","panels","validTabs","filter","t","validPanels","p","console","warn","map","tabKey","panelKey","preActiveTab","find","switchTab","tabElement","targetKey","tab","setAttribute","panel","removeAttribute","element","ev","cancelable","preventDefault","this","initTabContainer","initAll","e","link","target","closest","href","targetId","position","getBoundingClientRect","top","scrollTo","behavior","initSmoothScroll","question","answer","nextElementSibling","isOpen","toggle","style","height","overflow","display","scrollHeight","offsetHeight","initFaqAccordion","readyState"],"mappings":"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"}